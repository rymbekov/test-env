## Capacitor
Pics.io builds native mobile apps with the help of Capacitor tool. Root repo folders `ios` and `android` contain platform specific projects. XCode for iOS and Android Studio for Android. Folders content is generated and updated by Capacitor CLI, by running `npx cap init` and `npx cap sync` commands. Check the docs to get familiar with capacitor and it's tooling. 
https://capacitorjs.com/docs
https://www.youtube.com/watch?v=x2jRs7Qqai8

To implement iOS/Android native platform features like Push Notifications, app badges or calling system screens it uses Capacitor plugins. Check used plugins in `package.json` file.

All credentials need to be specified in `capacitor.config.json` and then sycned to project folderby running `npx cap sync`. CLI fills almost all required project settings. 

## Firebase
It uses Firebase to send Push notifications to iOS devices and Signin with Google button
https://console.firebase.google.com/u/2/project/io-pics-app/overview
This requires to identify clients in Firebase. Firebase is tightly linked to Google Cloud console. Once credentials crated via Firebase UI, they actually accessible in Google Cloud Admin web console. Firebase is like a lightweight UI for Google Console.
https://console.developers.google.com/apis/credentials?authuser=1&project=io-pics-app&supportedpurview=project

## Sign in with Google
Backend do not trust native app. =) Pics.io backend awaits only Google `access_token` to login clients from native apps. So client need to get this access token and send it to backend. Backend will fetch profile and then decide or not to log in user. 

## iOS 
iOS build in XCode. Needs simulatior.
Once build version uploaded to TestFlight, where QA team can test it. After that it send to review to AppStore. Main interface is https://appstoreconnect.apple.com/apps
There testers may be added to TestFlight.

### Build for iOS
IOS build happens on Mac with **installed XCode**.

Install actual version of XCode. It may require some extra moves depending on OS and XCode version.
Additionally `cocoapods` package manager should be installed in system. `sudo gem install cocoapods`

First, sync repo files Fill the required into XCode and Android studio `npx cap sync`

Open Xcode via `npx cap open ios`

Then build like a a generic project in XCode.

Probably version should be manually set in Project settings.

### Apple Certificates
Download from Apple Developer portal
• Development on device needs own certificate
• Publishing to AppStore needs own certificate
• Push Notifications needs own certificate
https://developer.apple.com/account/resources/certificates/list

### Known iOS issues
• Keep in mind, that iOS app has different from Android bundle name ` io.pics.ymainapp`, not sure wh and would be cool to synchronize it.
• Push notifications don't work locally.

## Android
Android builds in Android Studio. Needs emulatior. Emulator should contain Play API to be fully functional.

SignIn with Google done by Codetix plugin. Added as direct depencdency to the commit, since PR https://github.com/CodetrixStudio/CapacitorGoogleAuth/pull/173 is not released yet. Once released, may be replaced with NPM version.
https://www.youtube.com/watch?v=Rs1imvTbeN0

### Android keystores
Ask one of developers for JKS keystore that contains keys to sign an app. Otherwise we should go thru the process of identifying the autogenerated keystore. Default kdebug keystore password is `android`
https://stackoverflow.com/questions/12456491/i-dont-remember-my-android-debug-keystore-password

Keystore file is required to sign the APK.
Keystroke store password: `saCdq2BNZ2RHA62`
Key alias: `Pics.io`
Key password: `saCdq2BNZ2RHA62`




To debug Android Chrome inspect may be used. Visit chrome://inspect/#devices when app is running in simulator.
https://stackoverflow.com/questions/60792611/capacitor-compiled-ionic-app-how-to-debug-in-android-studio

To install APK to simulator, just drag and drop.
https://stackoverflow.com/questions/17167636/how-to-install-an-apk-on-the-emulator-in-android-studio

### Known Android issues
• The Firebase credentials and SHA already been configured. Don't go there alone, its so easy to get lost.
https://developers.google.com/android/guides/client-auth?authuser=2
• If SHA or client identity is not configured `ApiException: 10` will appears, sorry for that, you have to go thru this.
https://stackoverflow.com/questions/47437678
https://github.com/googlesamples/google-services/issues/360
• Project may need to be synced manually if changes made with Gradle files are
https://stackoverflow.com/questions/59808050/error-unable-to-find-module-with-gradle-path-capacitor-cordova-android-plugin
https://stackoverflow.com/questions/55057773/cordova-plugins-not-working-with-capacitor

https://capacitorjs.com/docs/android/troubleshooting




Useful links
https://firebase.google.com/docs/projects/api-keys
https://developer.android.com/studio/publish/app-signing
https://enappd.com/blog/google-login-in-ionic-react-capacitor-apps/122/
https://stackoverflow.com/questions/47632035/google-sign-in-error-12500
https://devdactic.com/capacitor-google-sign-in/
